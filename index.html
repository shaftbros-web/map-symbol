<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>地図記号4択ドリル - SVG版</title>
<style>
:root {
  --bg: #1e293b;      /* 少し明るめに修正 */
  --panel: #334155;
  --btn: #60a5fa;
  --fg: #f8fafc;
  --ok: #22c55e;
  --ng: #ef4444;
}
*{box-sizing:border-box}
html,body{height:100%;margin:0;background:var(--bg);color:var(--fg);font-family:sans-serif;display:grid;place-items:center}
#quiz{width:min(480px,95%);background:var(--panel);padding:20px;border-radius:12px;box-shadow:0 4px 12px #0008;text-align:center}
#symbol{height:180px;display:grid;place-items:center;margin-bottom:20px}
#symbol img{max-height:160px;max-width:100%}
button{display:block;width:100%;margin:8px 0;padding:12px;border:none;border-radius:8px;background:var(--btn);color:#fff;font-size:16px;cursor:pointer}
button:hover{opacity:.9}
#judge{position:fixed;inset:0;background:#0008;display:none;place-items:center;z-index:100}
#judge.show{display:grid}
#judgeMark{font-size:72px;font-weight:bold}
</style>
</head>
<body>
<div id="quiz">
  <h2>地図記号4択ドリル – SVG版（全問正解まで）</h2>
  <div id="symbol"></div>
  <div id="choices"></div>
</div>
<div id="judge"><div id="judgeMark"></div></div>
<script>
const symbols = [
  {file:"cityhall.svg", name:"市役所"},
  {file:"temple.svg", name:"寺院"},
  {file:"field.svg", name:"畑"},
  {file:"ruins.svg", name:"城跡"},
  {file:"hospital.svg", name:"病院"},
  {file:"school.svg", name:"小学校"},
  {file:"postoffice.svg", name:"郵便局"},
  {file:"library.svg", name:"図書館"},
  {file:"lighthouse.svg", name:"灯台"},
  {file:"museum.svg", name:"博物館"}
];
// GitHubのrawパスに合わせる（自分のリポジトリに置き換えてください）
const base = "https://raw.githubusercontent.com/あなたのユーザー名/リポジトリ名/main/symbols/";

let remain=[...symbols], current=null, canAdvance=false;

function shuffle(a){for(let i=a.length-1;i>0;i--){const j=Math.floor(Math.random()*(i+1));[a[i],a[j]]=[a[j],a[i]];}return a;}

function next(){
  if(remain.length===0){ alert("全問正解！おめでとう！"); location.reload(); return; }
  const idx = Math.floor(Math.random()*remain.length);
  current = remain[idx];
  $("#symbol").innerHTML = `<img src="${base}${current.file}" alt="">`;
  const names = shuffle([current.name, ...shuffle(symbols).filter(s=>s!==current).slice(0,3).map(s=>s.name)]);
  const wrap = $("#choices");
  wrap.innerHTML="";
  names.forEach(n=>{
    const b=document.createElement("button");
    b.textContent=n;
    b.addEventListener("click",(e)=>{ e.stopPropagation(); answer(n,current); });
    wrap.appendChild(b);
  });
}

function answer(ans,sym){
  const isOK = (ans===sym.name);
  showJudge(isOK);
  if(isOK){ remain = remain.filter(s=>s!==sym); }
}

function showJudge(isOK){
  const j=$("#judge"), m=$("#judgeMark");
  m.textContent = isOK ? "◯" : "×";
  m.style.color = isOK ? "var(--ok)" : "var(--ng)";
  j.classList.add("show");
  j.style.display="grid";
  canAdvance=false;
  setTimeout(()=>{canAdvance=true;},150);
  navigator.vibrate?.(isOK?20:[10,40,20]);
}

document.addEventListener("click",()=>{
  if($("#judge").classList.contains("show") && canAdvance){
    $("#judge").classList.remove("show");
    next();
  }
});

function $(s){return document.querySelector(s);}
next();
</script>
</body>
</html>
