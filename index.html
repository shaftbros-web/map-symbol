<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>地図記号クイズ</title>
<style>
  body {
    font-family: sans-serif;
    text-align: center;
    margin: 0;
    padding: 0;
    background: #f0f0f0;
  }
  #quiz-container {
    padding: 20px;
  }
  #symbol {
    width: 100px;
    height: 100px;
    margin: 20px auto;
  }
  .options {
    display: flex;
    flex-direction: column;
    gap: 10px;
    margin: 20px auto;
    max-width: 280px;
  }
  button {
    padding: 12px;
    font-size: 18px;
    border-radius: 6px;
    border: none;
    background: #007bff;
    color: white;
  }
  button:active {
    transform: scale(0.97);
  }
  #feedback {
    position: fixed;
    top: 30px;
    left: 50%;
    transform: translateX(-50%);
    font-size: 100px; /* ←大きくした */
    font-weight: bold;
    display: none;
    z-index: 1000;
    pointer-events: none;
  }
  #settings {
    margin-top: 20px;
  }
</style>
</head>
<body>
  <div id="quiz-container">
    <h2>地図記号クイズ</h2>
    <div id="symbol"></div>
    <div class="options" id="options"></div>
  </div>

  <div id="feedback"></div>

  <div id="settings">
    <label><input type="checkbox" id="forceCorrect"> 正解するまで進まない</label><br>
    <label><input type="checkbox" id="reviewMode" checked> 復習モードあり</label>
  </div>

<script>
const quizData = [
  { img: "symbols/school.svg", answer: "学校", options: ["学校", "病院", "図書館", "神社"] },
  { img: "symbols/hospital.svg", answer: "病院", options: ["役所", "病院", "工場", "水田"] }
];

let currentQuiz = 0;
let reviewList = [];
let reviewing = false;

const symbolEl = document.getElementById("symbol");
const optionsEl = document.getElementById("options");
const feedbackEl = document.getElementById("feedback");
const forceCorrectEl = document.getElementById("forceCorrect");
const reviewModeEl = document.getElementById("reviewMode");

function loadQuiz() {
  if (!reviewing && currentQuiz >= quizData.length) {
    if (reviewList.length > 0 && reviewModeEl.checked) {
      reviewing = true;
      currentQuiz = 0;
      alert("復習モード開始！");
    } else {
      alert("全問終了！");
      return;
    }
  }
  let data = reviewing ? reviewList[currentQuiz] : quizData[currentQuiz];
  symbolEl.innerHTML = `<img src="${data.img}" alt="symbol" width="100%">`;
  optionsEl.innerHTML = "";
  data.options.forEach(opt => {
    const btn = document.createElement("button");
    btn.textContent = opt;
    btn.onclick = () => checkAnswer(opt, data.answer);
    optionsEl.appendChild(btn);
  });
}

function checkAnswer(selected, correct) {
  if (selected === correct) {
    showFeedback("〇", "green");
    if (navigator.vibrate) navigator.vibrate(150);

    if (reviewing) {
      reviewList.splice(currentQuiz, 1);
      if (reviewList.length === 0) {
        reviewing = false;
        currentQuiz = 0;
        alert("復習モード終了！");
      }
    } else {
      currentQuiz++;
    }
    setTimeout(loadQuiz, 700);
  } else {
    showFeedback("×", "red");
    if (navigator.vibrate) navigator.vibrate([200, 100, 200]);

    if (reviewModeEl.checked && !reviewing) {
      reviewList.push(quizData[currentQuiz]);
    }
    if (!forceCorrectEl.checked) {
      currentQuiz++;
      setTimeout(loadQuiz, 700);
    }
  }
}

function showFeedback(mark, color) {
  feedbackEl.textContent = mark;
  feedbackEl.style.color = color;
  feedbackEl.style.display = "block";
  setTimeout(() => feedbackEl.style.display = "none", 600);
}

loadQuiz();
</script>
</body>
</html>
